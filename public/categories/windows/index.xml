<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Windows on My New Hugo Site</title><link>http://localhost:1313/categories/windows/</link><description>Recent content in Windows on My New Hugo Site</description><generator>Hugo</generator><language>en-us</language><lastBuildDate>Sun, 11 Feb 2024 21:49:07 +0000</lastBuildDate><atom:link href="http://localhost:1313/categories/windows/index.xml" rel="self" type="application/rss+xml"/><item><title>Had some fun today learning about WFP drivers</title><link>http://localhost:1313/docs/legacy/2024-02-11-windows-filtering-platform-wfp-overview/</link><pubDate>Sun, 11 Feb 2024 21:49:07 +0000</pubDate><guid>http://localhost:1313/docs/legacy/2024-02-11-windows-filtering-platform-wfp-overview/</guid><description>WFP is a network packet filtering framework provided by Windows. It provides API support for both user mode and kernel mode, and can be used to easily implement network packet interception/editing, commonly used to implement firewalls, speed control and intrusion detection.
The WFP architecture is shown in the figure above. Although it provides user mode and kernel mode interfaces, the actual work is done in the kernel layer.
The main part of the WFP framework is the Filter Engine in the figure, which interacts and operates with the operating system’s network stack, and can process data in the network stack to implement data filtering and other functions.</description></item><item><title>Encountering issues with Azure IAAS Virtual Machines not joining Azure AD post-deployment from a sysprepped template?</title><link>http://localhost:1313/docs/legacy/2024-02-02-azure-vm-deployment-azure-ad-issue/</link><pubDate>Fri, 02 Feb 2024 11:09:15 +0000</pubDate><guid>http://localhost:1313/docs/legacy/2024-02-02-azure-vm-deployment-azure-ad-issue/</guid><description>Sysprep is designed to prepare an installation of Windows for duplication, clearing out specific information like registry keys, certificates, and more to avoid duplication errors. Yet, it doesn’t entirely remove all data, especially those related to Azure AD/Microsoft Entra ID or Intune enrollments. These services attach certificates and store various information across the registry, which sysprep overlooks.
Cloning a device already joined to AzureAD/Microsoft Entra ID or enrolled in Intune creates identical digital twins from Azure’s AAD/Entra perspective, making it impossible for Azure AD/Intune to differentiate between them due to identical device IDs and certificates.</description></item><item><title>How to Create Your Own Custom Filter Driver for Windows</title><link>http://localhost:1313/docs/legacy/2024-02-01-create-custom-filter-driver-windows/</link><pubDate>Thu, 01 Feb 2024 01:25:46 +0000</pubDate><guid>http://localhost:1313/docs/legacy/2024-02-01-create-custom-filter-driver-windows/</guid><description>A Windows Filter Driver is a specialized driver within the Microsoft Windows operating system. It serves as a mechanism to intercept and modify the behavior of specific system operations. These drivers function at a low level within the operating system, enabling the monitoring or alteration of interactions between the OS and its hardware or software components. Filter drivers essentially “filter” I/O requests (input/output), intercepting and potentially modifying them for a particular device or file system.</description></item><item><title>How to install WinDBG preview (Windows Store version) on Windows Server?</title><link>http://localhost:1313/docs/legacy/2024-01-30-install-windbg-windows-server-no-windows-store/</link><pubDate>Tue, 30 Jan 2024 11:20:24 +0000</pubDate><guid>http://localhost:1313/docs/legacy/2024-01-30-install-windbg-windows-server-no-windows-store/</guid><description>Windows Debugger is an essential tool for developers and IT professionals working with Windows environments. However, if you’re using Windows Server, you might encounter a unique challenge: WinDbg preview is typically available as a Windows Store package, but Windows Server installations do not include the Windows Store. This guide will walk you through an alternative method to install WinDbg on your Windows Server.
The first step is to visit the official WinDbg documentation page at Microsoft’s WinDbg Guide.</description></item><item><title>PowerShell: Create a New Domain Admin User</title><link>http://localhost:1313/docs/legacy/2023-12-01-recover-azure-vm-domain-admin-access/</link><pubDate>Fri, 01 Dec 2023 09:05:10 +0000</pubDate><guid>http://localhost:1313/docs/legacy/2023-12-01-recover-azure-vm-domain-admin-access/</guid><description>If you have deployed a Windows Virtual Machine from the Azure Marketplace that comes with a domain controller pre-installed, and your local domain admin password has expired, you will not be able to recover access using Azure’s built-in password recovery tool, as it is not supported on domain controllers. However, you can use the script provided below as a Run Command to create a new domain admin user and regain access:</description></item><item><title>Current configuration options for SMB 1.0 in Windows Environments</title><link>http://localhost:1313/docs/legacy/2023-11-06-manage-smb-1-windows/</link><pubDate>Mon, 06 Nov 2023 11:38:12 +0000</pubDate><guid>http://localhost:1313/docs/legacy/2023-11-06-manage-smb-1-windows/</guid><description>SMB 1.0 is an older protocol version that, despite its vulnerabilities, remains necessary for compatibility with certain legacy systems. Due to these security risks, modern Windows installations have moved away from SMB 1.0 in favor of its successors, SMB 2.0 and 3.0. Managing SMB 1.0 in modern Windows environments requires understanding the tools available for enabling or disabling it. Here’s a look at these tools and how they interact:
Windows Feature Toggle: Controls the installation of SMB 1.</description></item><item><title>How to Upgrade Legacy Azure Windows VMs Not Supported by Azure&amp;#8217;s Native In-Place Upgrade Feature</title><link>http://localhost:1313/docs/legacy/2023-09-27-how-to-upgrade-legacy-azure-windows-vms/</link><pubDate>Wed, 27 Sep 2023 00:39:31 +0000</pubDate><guid>http://localhost:1313/docs/legacy/2023-09-27-how-to-upgrade-legacy-azure-windows-vms/</guid><description>In a previous guide, we discussed upgrading Windows Server 2012 R2 (WS2012R2) in Azure using Azure’s native upgrade mechanism. However, what do you do if you’re dealing with a legacy workload? If you’re concerned about the long-term security and supportability of your VM, and redeploying or moving everything within the OS isn’t feasible, this guide is for you. Here, I’ll walk you through the process of upgrading a legacy Azure Windows VM without relying on any on-premises solutions or exporting the drive.</description></item><item><title>Deploy Storage Spaces on a Single Virtual Machine to Get Optimal Performance/Cost Ratio</title><link>http://localhost:1313/docs/legacy/2023-09-25-deploy-storage-spaces-on-azure-vm/</link><pubDate>Mon, 25 Sep 2023 22:10:24 +0000</pubDate><guid>http://localhost:1313/docs/legacy/2023-09-25-deploy-storage-spaces-on-azure-vm/</guid><description>Storage Spaces is a feature of Windows Server that allows you to pool multiple physical disks together to create a single virtual disk. This can be useful for a variety of reasons, such as:
To increase the overall capacity of your storage. To improve the performance of your storage by distributing data across multiple disks. To get azure host caching feature on disks that are higher than 4 TB. In this article, I will show you how to deploy Storage Spaces on a single virtual machine in Azure to achieve optimal storage performance with minimal cost.</description></item><item><title>In Place Upgrade Your Windows Server Azure VM: Step by Step Guide</title><link>http://localhost:1313/docs/legacy/2023-09-24-windows-server-azure-vm-in-place-upgrade/</link><pubDate>Sun, 24 Sep 2023 16:28:12 +0000</pubDate><guid>http://localhost:1313/docs/legacy/2023-09-24-windows-server-azure-vm-in-place-upgrade/</guid><description>Upgrading your Windows Server Azure VM to a newer version can seem daunting, but with the right steps, it can be a smooth process. This guide will walk you through a step-by-step process, complete with visuals, to upgrade your Windows VM in Azure, for instance, from WS 2016 to 2019.
Prerequisites for a Successful Upgrade # Before diving into the upgrade, ensure the following prerequisites are met:
Managed Disk Usage</description></item><item><title>How to resolve the NLA error in Azure VMs when the computer object is removed from Active Directory</title><link>http://localhost:1313/docs/legacy/2023-09-22-how-to-resolve-the-nla-error-in-azure-vms-when-the-computer-object-is-removed-from-active-directory/</link><pubDate>Fri, 22 Sep 2023 21:05:09 +0000</pubDate><guid>http://localhost:1313/docs/legacy/2023-09-22-how-to-resolve-the-nla-error-in-azure-vms-when-the-computer-object-is-removed-from-active-directory/</guid><description>If you’re working with Azure Virtual Machines, you might encounter a situation where you see an error related to Network Level Authentication. This typically arises when your VM loses communication with the Domain Controller, the trust relationship between the VM and DC is compromised, or the VM’s computer object has been removed from the DC.
Navigate to the Azure portal.
Locate the VM that is experiencing the NLA error.
Click Run Command.</description></item><item><title>Why can&amp;#8217;t I resize the underlying storage used by Storage Spaces?</title><link>http://localhost:1313/docs/legacy/2023-09-21-why-cant-i-resize-the-underlying-storage-used-by-storage-spaces-direct/</link><pubDate>Thu, 21 Sep 2023 22:56:14 +0000</pubDate><guid>http://localhost:1313/docs/legacy/2023-09-21-why-cant-i-resize-the-underlying-storage-used-by-storage-spaces-direct/</guid><description>Storage Spaces is a Windows Server storage technology that pools the storage capacity of multiple disks into a single virtual disk. This technology is often used to create highly available and scalable storage solutions for virtual machines and other workloads.
One of the limitations of Storage Spaces is that it does not support resizing the underlying storage. This means that if you need to add more storage to a Storage Spaces, you must do so by adding new drives.</description></item><item><title>PowerShell: Create a NAT VMSwitch on Hyper-V</title><link>http://localhost:1313/docs/legacy/2023-09-18-powershell-create-a-nat-vmswitch-on-hyper-v/</link><pubDate>Mon, 18 Sep 2023 09:38:37 +0000</pubDate><guid>http://localhost:1313/docs/legacy/2023-09-18-powershell-create-a-nat-vmswitch-on-hyper-v/</guid><description>https://learn.microsoft.com/en-us/virtualization/hyper-v-on-windows/user-guide/setup-nat-network
Live migration in clustered scenario won’t work for VMs using this NAT.
Quick migration will work.
Define the NAT Switch Name and NAT Configuration Parameters # $switchName = &amp;ldquo;NATSwitch&amp;rdquo; $natSubnet = &amp;ldquo;192.168.100.0/24&amp;rdquo; $gatewayAddress = &amp;ldquo;192.168.100.1&amp;rdquo; $netAdapaterName = &amp;ldquo;vEthernet (&amp;quot;+$switchName+&amp;rdquo;)&amp;quot;
Create a new virtual switch # New-VMSwitch -SwitchName $switchName -SwitchType Internal
Retrieve the actual Network Adapter for the created switch # $netAdapter = Get-NetAdapter -Name $netAdapaterName
Set the IP address on the NAT Gateway (the virtual switch) # New-NetIPAddress -IPAddress $gatewayAddress -PrefixLength 24 -InterfaceIndex $netAdapter.</description></item><item><title>PowerShell: Gather DNS Server Logs from Windows</title><link>http://localhost:1313/docs/legacy/2023-09-13-powershell-gather-dns-server-logs-from-windows/</link><pubDate>Wed, 13 Sep 2023 14:25:29 +0000</pubDate><guid>http://localhost:1313/docs/legacy/2023-09-13-powershell-gather-dns-server-logs-from-windows/</guid><description> if (-not (Test-Path $destDirectory)) { New-Item -ItemType Directory -Path $destDirectory }
Get-WinEvent -LogName &amp;lsquo;DNS Server&amp;rsquo; | Export-Csv -Path &amp;ldquo;$destDirectory\DNSServerEvents.csv&amp;rdquo; -NoTypeInformation
dnscmd /info &amp;gt; &amp;ldquo;$destDirectory\DNSConfig.txt&amp;rdquo;
Write-Output &amp;ldquo;Diagnostic logs have been gathered and saved to $destDirectory&amp;rdquo; &amp;quot; role=&amp;ldquo;button&amp;rdquo; style=&amp;ldquo;color:#D4D4D4;display:none&amp;rdquo; tabindex=&amp;ldquo;0&amp;rdquo;&amp;gt;``` $destDirectory = &amp;ldquo;C:\DNSLogs&amp;rdquo; if (-not (Test-Path $destDirectory)) { New-Item -ItemType Directory -Path $destDirectory } Get-WinEvent -LogName &amp;lsquo;DNS Server&amp;rsquo; | Export-Csv -Path &amp;quot;$destDirectory\DNSServerEvents.csv&amp;quot; -NoTypeInformation dnscmd /info &amp;gt; &amp;quot;$destDirectory\DNSConfig.txt&amp;quot; Write-Output &amp;ldquo;Diagnostic logs have been gathered and saved to $destDirectory&amp;quot; &amp;lt;/div&amp;gt;</description></item><item><title>Powershell: Tracking Last Domain Login Events on Azure VMs</title><link>http://localhost:1313/docs/legacy/2023-09-11-tracking-last-domain-login-events-on-azure-vms-a-handy-script/</link><pubDate>Mon, 11 Sep 2023 07:29:10 +0000</pubDate><guid>http://localhost:1313/docs/legacy/2023-09-11-tracking-last-domain-login-events-on-azure-vms-a-handy-script/</guid><description>When managing virtual machines (VMs) in a cloud environment like Azure, it’s crucial to monitor user activities for various reasons. Whether it’s for auditing, security, or simply to track unused resources, knowing the last time someone logged in can provide valuable insights. If you’re not sure whether anyone is even logging into your Azure VM, you can check the last domain login events without breaking a sweat. All you need is PowerShell and Azure’s “Run Command” feature.</description></item><item><title>How Hyper-V Works, High Level Overview</title><link>http://localhost:1313/docs/legacy/2023-09-10-how-hyper-v-works-high-level-overview/</link><pubDate>Sun, 10 Sep 2023 19:28:13 +0000</pubDate><guid>http://localhost:1313/docs/legacy/2023-09-10-how-hyper-v-works-high-level-overview/</guid><description>Hyper-V stands as Microsoft’s first standalone hypervisor, offering extensive support for the x86-64 architecture. It has established its own space in the virtualization market, going toe-to-toe with competitors like VMware ESXi, Xen, and KVM. One of its distinct advantages is its native integration with Microsoft-centric environments.
Contrary to many Type 2 hypervisors that function atop an existing operating system, Hyper-V is a Type 1 hypervisor that interacts directly with the hardware.</description></item><item><title>Understanding AMSI: The Antimalware Scan Interface in Windows Systems</title><link>http://localhost:1313/docs/legacy/2023-09-05-understanding-amsi-the-antimalware-scan-interface-in-windows-systems/</link><pubDate>Tue, 05 Sep 2023 20:28:06 +0000</pubDate><guid>http://localhost:1313/docs/legacy/2023-09-05-understanding-amsi-the-antimalware-scan-interface-in-windows-systems/</guid><description>The Antimalware Scan Interface (AMSI) is a key element in Windows’ cybersecurity framework, often working behind the scenes to protect your system from malicious software. It serves as an intermediary between software and installed antivirus solutions, providing an extra layer of security for the system. Introduced in 2015 with Windows 10, AMSI has been an integral part of subsequent Windows versions.
Structurally, AMSI functions as an integrated application equipped with an open system API.</description></item><item><title>How to Track Registry Key Modifications Using Process Monitor</title><link>http://localhost:1313/docs/legacy/2023-08-28-how-to-track-registry-key-modifications-using-process-monitor/</link><pubDate>Mon, 28 Aug 2023 12:57:25 +0000</pubDate><guid>http://localhost:1313/docs/legacy/2023-08-28-how-to-track-registry-key-modifications-using-process-monitor/</guid><description>Modifying registry keys is a common operation that can be performed by both system and user processes. But what happens when a registry key value changes unexpectedly, leading to system behavior that’s hard to diagnose? Knowing exactly which process modified a registry key can be invaluable in system administration and debugging scenarios. One powerful tool that can help you identify such changes in real-time is Sysinternals Process Monitor.
In this blog post, I’ll guide you through setting up Process Monitor to capture only the relevant events related to a specific registry key modification.</description></item><item><title>Azure Nested Virtualization: Hyper-V cannot be installed because virtualization support is not enabled in the BIOS.</title><link>http://localhost:1313/docs/legacy/2023-08-25-azure-nested-virtualization-hyper-v-cannot-be-installed-because-virtualization-support-is-not-enabled-in-the-bios/</link><pubDate>Fri, 25 Aug 2023 16:54:41 +0000</pubDate><guid>http://localhost:1313/docs/legacy/2023-08-25-azure-nested-virtualization-hyper-v-cannot-be-installed-because-virtualization-support-is-not-enabled-in-the-bios/</guid><description>Nested virtualization is an exciting and powerful feature that allows you to run a virtual machine within another virtual machine. This capability has numerous applications in the fields of development, testing, and security. However, when trying to enable it in Azure, you may encounter a specific error related to nested virtualization:
Fortunately, the fix for this problem is relatively straightforward and can be done directly through the Command Prompt. Here’s a step-by-step guide:</description></item><item><title>How to restart Group Policy Client Service (GPSVC)</title><link>http://localhost:1313/docs/legacy/2023-08-24-how-to-restart-group-policy-client-service-gpsvc/</link><pubDate>Thu, 24 Aug 2023 14:54:07 +0000</pubDate><guid>http://localhost:1313/docs/legacy/2023-08-24-how-to-restart-group-policy-client-service-gpsvc/</guid><description>Are you facing difficulties in restarting the Group Policy Client service? It’s a common issue that many have run into, especially when they find the option grayed out in the services list or receive an “Access is Denied” error from the command line. Let’s dive into why this happens and how you can get around it.
Understanding the Issue # The Group Policy Client service requires specific permissions to manage, specifically System account permissions.</description></item></channel></rss>